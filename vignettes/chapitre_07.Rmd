---
title: Exercices corrigés du chapitre 7
author: Yves Croissant
output: 
  html_document:
    toc: true
    toc_float: true
  pdf_document:
    number_sections: true
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{Exercices corrigés du chapitre 7}
  %\VignetteEngine{knitr::rmarkdown}
---

### Exercice 1 {-}

#### Intitulé

On considère la vente de raie fleurie à la criée en France entre 2015
et 2019\ :

```{r echo = FALSE, message = FALSE}
library("lubridate")
library("dplyr")
library("statecoaes")
sum2string <- function(x, d = 3) paste(round(x, d), collapse = " + ")
sumprod <- function(x, y, dx = 3, dy = 3) paste(round(x, dx), round(y, dy), sep = "\\times", collapse = " + ")
vect2string <- function(x, d = 3) paste("(", paste(round(x, 3), collapse = ", "), ")", sep = "")
fmt <- function(x) format(x, scientific = FALSE, big.mark = " ")
Raies <- Poissons %>% mutate(an = year(floor_date(dmy(date), "year"))) %>%
    group_by(poisson, an) %>%
    summarise(poids = sum(poids) / 1E03, valeur = sum(valeur) / 1E03) %>%
    mutate(prix = valeur / poids) %>%
    select(poisson, an, quant = poids, prix, recette = valeur) %>% 
    filter(poisson %in% c("Raie Bouclee", "Raie Douce", "Raie Fleurie")) %>%
    ungroup %>%
    filter(an %in% c(2015:2019))
RaieFleurie <- Raies %>% filter(poisson == "Raie Fleurie") %>% select(- poisson)
RaieFleurie %>% 
    knitr::kable(booktabs = TRUE, escape = FALSE, digits = c(0, 0, 3, 0)) %>%
    kableExtra::kable_styling(position = "center")
```
Les quantités (`quant`) sont mesurées en tonnes, le prix en euros par
kilogramme et la recette, produit des quantités et du prix, est donc
mesurée en millions d'euros. 

1. Calculez le coefficient multiplicateur, le coefficient de variation
   relative et l'indice d'évolution du prix pour 2019 par rapport à 2015.
1. Appliquez la propriété de réversibilité pour calculer l'indice de
   prix pour l'année 2015 en base 2019.
1. Calculez de deux manières différentes l'indice de prix pour l'année
   2019 en base 2017 (directement et en utilisant la propriété de
   circularité).
1. Calculez à nouveau l'indice de prix de l'année 2019 en base 2015
   à partir des 4 indices de prix pour l'année $t$ en base $t-1$.
1. Calculez l'indice de la quantité pour l'année 2019 en base 2015.
1. Calculez l'indice de la recette pour l'année 2019 en base 2015 de
   deux manières différentes.

#### Corrigé


```{r echo = FALSE}
prix_15 <- RaieFleurie %>% pull(prix) %>% .[1]
prix_19 <- RaieFleurie %>% pull(prix) %>% .[5]
prix_17 <- RaieFleurie %>% pull(prix) %>% .[3]
prix_18 <- RaieFleurie %>% pull(prix) %>% .[4]
prix_16 <- RaieFleurie %>% pull(prix) %>% .[2]
qute_15 <- RaieFleurie %>% pull(quant) %>% .[1]
qute_19 <- RaieFleurie %>% pull(quant) %>% .[5]
val_15 <- RaieFleurie %>% pull(recette) %>% .[1]
val_19 <- RaieFleurie %>% pull(recette) %>% .[5]
```

**Q1.**  Le prix en 2015 est `r round(prix_15, 3)`, celui en 2019 est 
`r round(prix_19, 3)`. 

- Le coefficient multiplicateur est\ : $i_{19/15} = \frac{p_{19}}{p_{15}} = 
    `r round(prix_19 / prix_15, 3)`$.
- Le coefficient de variation relative est\ :
    $cv_{19/15} = \frac{p_{19} - p_{15}}{p_{15}} = \frac{p_{19}}{p_{15}} - 1 =
	`r round(prix_19 / prix_15 - 1, 3)`$, soit
	`r round(prix_19 / prix_15 * 100 - 100, 1)`%.
- l'indice de prix en base 100 pour l'année 2015 est\ :
    $I_{19/15} = \frac{p_{19}}{p_{15}} \times 100 = 
	`r round(prix_19 / prix_15 *  100, 1)`$.

**Q2.**  La propriété de réversibilité implique que $i_{o/t} = 1 /
   i_{t/o}$. On a ici $i_{19/15}=`r round(prix_19 / prix_15, 3)`$ et
   donc $i_{15/19} = 1 / i_{19/15} = `r round(prix_15 / prix_19, 3)`$. 
   En base 100, on obtient $I_{15/19} = `r round(prix_15 / prix_19 * 100, 1)`$.

**Q3.** Le prix en 2017 est `r round(prix_17, 3)`. L'indice de prix pour
   2019 en base 2017 peut être calculé directement\ : 
   $i_{19/17}=\frac{p_{19}}{p_{17}}=`r round(prix_19 / prix_17, 3)`$
   ou en calculant l'indice de prix pour la nouvelle base par rapport
   à l'ancienne\ : $i_{17/15}=\frac{p_{17}}{p_{15}}=`r round(prix_19 / prix_17, 3)`$ 
   et en divisant l'ancien indice par celui-ci\ :
   $i_{19/17}=\frac{i_{19/15}}{i_{17/15}}=\frac{`r round(prix_19 / prix_15, 3)`}
   {`r round(prix_17 / prix_15, 3)`} = `r round(prix_19/prix_17, 3)`$.

**Q4.**  $i_{19/15} = i_{16/15} \times i_{17/16} \times i_{18/17} \times i_{19/18}=
   `r round(prix_16/prix_15, 3)` \times `r round(prix_17/prix_16, 3)` \times 
   `r round(prix_18/prix_17, 3)` \times `r round(prix_19/prix_18, 3)`  =
   `r round(prix_19/prix_15, 3)`$

**Q5.**  L'indice de quantité pour l'année 2019 en base 2015 est obtenu en
   divisant la quantité de 2019 (`r round(qute_19, 3)`) par celle de
   2015 (`r round(qute_15, 3)`), soit 
   $i_{19/15} = `r round(qute_19/qute_15, 3)`$, soit encore en base
   100\ : $I_{19/15} = `r round(qute_19/qute_15 * 100, 1)`$.

**Q6.**  L'indice de recette de l'année 2019 en base 2015 peut être obtenu
   directement en divisant les recettes de 2019 `r round(val_19, 0)`
   par celles de 2015 `r round(val_15, 0)`, soit 
   $i_{19/15} = `r round(val_19 / val_15, 3)`$. Il peut également
   être obtenu en multipliant l'indice de prix 
   ($i_{19/15}^p = `r round(prix_19/prix_15, 3)`$) et celui des
   quantités ($i_{19/15}^q = `r round(qute_19/qute_15, 3)`$), soit 
   $`r round(prix_19/prix_15, 3)` \times `r round(qute_19/qute_15, 3)`=
   `r round(val_19 / val_15, 3)`$.

### Exercice 2 {-}

#### Intitulé

Il y a en France principalement trois espèces de raies qui sont
pêchées\ : la raie bouclée, la raie douce et la raie fleurie. Les
valeurs pour les deux années 2015 et 2019 sont données dans le tableau
ci-dessous.

```{r echo = FALSE}
Raies2 <- Raies %>% filter(an %in% c(2015, 2019))
Raies2 %>%
    knitr::kable(booktabs = TRUE, escape = FALSE, digits = c(0, 0, 0, 3, 0)) %>%
    kableExtra::kable_styling(position = "center")
```

1. Calculez l'indice de la recette totale pour 2019 en base 2015.
1. Calculez les indices de prix et de quantité de Laspeyres.
1. Calculez les indices de prix et de quantité de Paasche. 
1. Calculez les indices de prix de Laspeyres et de Paasche exprimés
   comme des moyennes des indices de prix élémentaires pondérées par
   les coefficients budgétaires.
1. Calculez les indices de prix et de quantité de Fisher. Comparez
   avec les indices de Laspeyres et de Paasche.
1. Retrouvez l'indice de la recette totale pour 2019 en base 2015
   calculé dans la question 1 de trois manières différentes en
   utilisant les indices de Laspeyres, Paasche et Fisher.


#### Corrigé

```{r echo = FALSE}
base <- 15
int <- 19
an_base <- 2000 + base
an_int <- 2000 + int
pos_base <- c(1, 3, 5)
pos_int <- c(2, 4, 6)
p_base.q_int <- sum(Raies2$prix[pos_base] * Raies2$quant[pos_int])
p_int.q_base <- sum(Raies2$prix[pos_int] * Raies2$quant[pos_base])
p_int.q_int <- sum(Raies2$prix[pos_int] * Raies2$quant[pos_int])
p_base.q_base <- sum(Raies2$prix[pos_base] * Raies2$quant[pos_base])
L_p <- p_int.q_base / p_base.q_base
L_q <- p_base.q_int / p_base.q_base
P_p <- p_int.q_int / p_base.q_int
P_q <- p_int.q_int / p_int.q_base
F_p <- sqrt(L_p * P_p)
F_q <- sqrt(L_q * P_q)
cbudg_base <- Raies2$recette[pos_base] / p_base.q_base
cbudg_int <- Raies2$recette[pos_int] / p_int.q_int
p_elem <- Raies2$prix[pos_int] / Raies2$prix[pos_base]
```

**Q1.** L'indice de la recette totale est un indice élémentaire car
les recettes correspondant aux différents types de poisson sont
mesurées en euros et peuvent donc être sommées. On calcule donc\: 

- la recette totale  en `r an_base`\ :
$\sum_i v_{i`r base`} = \sum_i p_{i`r base`} q_{i`r base`}=
`r sum2string(Raies2$recette[pos_base], 0)` = `r fmt(round(p_base.q_base))`$,
- la recette totale  en `r an_int`\ :
$\sum_i v_{i`r int`} = \sum_i p_{i`r int`} q_{i`r int`}=
`r sum2string(Raies2$recette[pos_int], 0)` = `r fmt(round(p_int.q_int))`$,
et l'indice de la recette totale pour `r an_int` en base 100 pour `r an_base` 
est $\frac{`r fmt(round(p_int.q_int))`}
{`r fmt(round(p_base.q_base))`}\times 100 = 
`r round(p_int.q_int / p_base.q_base * 100, 1)`$.


**Q2.** Pour l'indice de prix de Laspeyres, on calcule\ :

- la recette correspondant aux quantités de `r an_int` et aux prix
 de `r an_base`\ :
$\sum_i p_{i`r base`} q_{i`r int`}=
`r sumprod(Raies2$prix[pos_base], Raies2$quant[pos_int], 3, 0)` = `r fmt(round(p_base.q_int))`$.
- la recette correspondant aux prix de `r an_int` et aux  quantités
 `r an_base`\ :
$\sum_i p_{i`r int`} q_{i`r base`}=
`r sumprod(Raies2$prix[pos_int], Raies2$quant[pos_base], 3, 0)` = `r fmt(round(p_int.q_base))`$.

L'indice des prix est alors égal à\ :
$L^p_{`r int`/`r base`} = \frac{\sum_i p_{i`r int`} q_{i`r base`}}{\sum_i p_{i`r base`} q_{i`r base`}}=
\frac{`r fmt(round(sum(Raies2$prix[pos_int] * Raies2$quant[pos_base])))`}
{`r fmt(round(p_base.q_base))`}=
`r round(L_p, 3)`$ 
 alors que l'indice des quantités est\ :
$L^q_{`r int`/`r base`} = \frac{\sum_i p_{i`r base`} q_{i`r int`}}{\sum_i p_{i`r base`} q_{i`r base`}}=
\frac{`r fmt(round(p_base.q_int))`}
{`r fmt(round(p_base.q_base))`}=
`r round(L_q, 3)`$ 

**Q3.** L'indice des prix de Paasche est égal à\ :
$P^p_{`r int`/`r base`} = \frac{\sum_i p_{i`r int`} q_{i`r int`}}{\sum_i p_{i`r base`} q_{i`r int`}}=
\frac{`r fmt(round(p_int.q_int))`}
{`r fmt(round(p_base.q_int))`}=
`r round(P_p, 3)`$ 
 alors que l'indice des quantités est\ :
$P^q_{`r int`/`r base`} = \frac{\sum_i p_{i`r int`} q_{i`r int`}}{\sum_i p_{i`r int`} q_{i`r base`}}=
\frac{`r fmt(round(p_int.q_int))`}
{`r fmt(round(p_int.q_base))`}=
`r round(P_q, 3)`$ 
	 
**Q4.** Commençons par calculer les coefficients budgétaires pour les
trois types de raies. Par exemple, pour l'année `r an_base`, la
recette correspondant à la raie bouclée est de `r fmt(round(Raies2$recette[1]))` 
et la recette totale est de `r fmt(round(p_base.q_base))`. La part
budgétaire de la raie bouclée est donc de 
$\frac{`r fmt(round(Raies2$recette[1]))`}{`r fmt(round(p_base.q_base))`}=
`r round(Raies2$recette[1] /  p_base.q_base, 3)`$, ce qui signifie
qu'en `r an_base`, 
$`r round(Raies2$recette[1] /  p_base.q_base * 100,  1)`$% 
de la recette correspondant à la vente de raies est attribuable à la
raie bouclée. Plus généralement, on obtient, pour l'année `r an_base`
$\omega_{`r base`} = `r vect2string(cbudg_base, 3)`$ et pour l'année `r an_int`
$\omega_{`r int`} = `r vect2string(cbudg_int, 3)`$.

Calculons ensuite les indices élémentaires des prix des trois types de
raies. Par exemple, pour la raie bouclée, on a 
$\frac{`r round(Raies2$prix[2], 3)`}{`r round(Raies2$prix[1], 3)`}=
`r round(Raies2$prix[2] / Raies2$prix[1], 3)`$. Plus généralement, on
obtient pour les trois types de raies\ :
$p_{`r int`/`r base`} = `r vect2string(p_elem, 3)`$.

L'indice de prix de Laspeyres est la moyenne arithmétique des indices
de prix élémentaires pondérée par les coefficients budgétaires de
l'année de base\: 

$$L^p_{`r int`/`r base`}= \left(`r sumprod(cbudg_base, p_elem)`\right)
\times 100 = 
`r round(sum(p_elem * cbudg_base * 100), 1)`$$

L'indice de prix de Paasche est la moyenne harmonique des indices de
prix élémentaires pondérée par les coefficients budgétaires de l'année
d'intérêt\ :

$$p^p_{`r int`/`r base`}= \frac{100}
{`r round(cbudg_int[1], 3)` \frac{1}{`r round(p_elem[1], 3)`} + 
`r round(cbudg_int[2], 3)` \frac{1}{`r round(p_elem[2], 3)`} + 
`r round(cbudg_int[3], 3)` \frac{1}{`r round(p_elem[3], 3)`}}=
`r round(100 / sum(cbudg_int / p_elem), 1)`$$

L'indice de prix de Laspeyres est supérieur à celui de Paasche (et
c'est également le cas pour l'indice des quantités). Ce résultat
serait général dans le cas où les pondérations utilisées dans les deux
indices seraient les mêmes, car une moyenne arithmétique (indice de
Laspeyres) est nécessairement supérieure à une moyenne harmonique
(indice de Paasche). Ici, les pondérations ne sont pas les mêmes car
il s'agit respectivement des coefficients budgétaires de l'année 
`r an_base`  et de l'année `r an_int`
pour les indices de Laspeyres et de Paasche.

**Q5.** L'indice de Fisher est la moyenne géométrique des indices de
Laspeyres et de Paasche. On a donc\ :

$$
F^p_{`r int`/`r base`}=\sqrt{L^p_{`r int`/`r base`}P^p_{`r int`/`r base`}}
\sqrt{`r round(L_p * 100, 1)` \times `r round(P_p * 100, 1)`}=
`r round(sqrt(L_p * P_p) * 100, 1)`
$$

$$
F^q_{`r int`/`r base`}=\sqrt{L^q_{`r int`/`r base`}P^q_{`r int`/`r base`}}
\sqrt{`r round(L_q * 100, 1)` \times `r round(P_q * 100, 1)`}=
`r round(sqrt(L_q * P_q) * 100, 1)`
$$

L'indice de Fisher prend une valeur intermédiaire entre les indices de
Laspeyres et de Paasche, ce qui est normal car il s'agit d'une moyenne
(géométrique) de ces deux indices.

**Q6.** L'indice d'évolution de la recette est le produit\ :

- de l'indice de Laspeyres des prix et de l'indice de Paasche des
  quantités\ : 
  $I^v_{`r int`/`r base`} = `r round(L_p * 100, 1)` \times 
  `r round(P_q * 100, 1)` / 100 = `r round(L_p * P_q * 100, 1)`$
- de l'indice de Paasche des prix et de l'indice de Laspeyres des
  quantités\ : 
  $I^v_{`r int`/`r base`} = `r round(P_p * 100, 1)` \times 
  `r round(L_q * 100, 1)` / 100 = `r round(P_p * L_q * 100, 1)`$
- de l'indice de Fisher des prix et des quantités\ : 
  $I^v_{`r int`/`r base`} = `r round(F_p * 100, 1)` \times 
  `r round(F_q * 100, 1)` / 100 = `r round(F_p * F_q * 100, 1)`$

  
