---
title: Exercices corrigés du chapitre 5
author: Yves Croissant
output: 
  html_document:
    toc: true
    toc_float: true
  pdf_document:
    number_sections: true
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{Exercices corrigés du chapitre 5}
  %\VignetteEngine{knitr::rmarkdown}
---

### Exercice 1 {-}

#### Intitulé

On considère la répartition des entreprises françaises selon le nombre
de salariés (par tranche) et par secteur d'activité\ :


```{r tailsect, echo = FALSE, message = FALSE}
library("statecoaes")
library("dplyr")
library("descstat")
clap_def <- Clap %>% filter(taille != "0") %>% group_by(secteur, taille) %>%
    summarise(nombre = sum(nombre)) %>%
    cont_table(secteur, taille, freq = nombre)
clap_def %>% pre_print() %>% knitr::kable(booktabs = TRUE, escape = FALSE, digits = 2) %>%
    kableExtra::kable_styling(position = "center")
```

1. Calculez le nombre d'entreprises industrielles.
1. Calculez la part des entreprises industrielles. Caractérisez cette
   valeur.
1. Calculez le nombre d'entreprises dont la taille est comprise entre
   10 et 20 salariés.
1. Calculez la part des entreprises qui sont industrielles et dont le
   nombre de salariés est compris entre 10 et 20. Caractérisez cette
   valeur.
1. Calculez la part des entreprises industrielles dont le nombre de
   salariés est compris entre 10 et 20. Caractérisez cette valeur.
1. Calculez la part des entreprises dont le nombre de salariés est
   compris entre 10 et 20 qui sont des entreprises
   industrielles. Caractérisez cette valeur.
   

#### Corrigé

```{r echo = FALSE}
nb_indus <- clap_def %>% filter(secteur == "Industrie") %>% pull(n) %>% sum
nb_1020 <- clap_def %>% filter(taille == "[10,20)") %>% pull(n) %>% sum
nb_1020_indus <- clap_def %>% filter(taille == "[10,20)", secteur == "Industrie") %>% pull
nb_tot <- clap_def %>% pull(n) %>% sum
part_indus <- nb_indus / nb_tot
part_1020 <- nb_1020 / nb_tot
```

**Q1.** Le nombre total d'entreprises industrielles s'obtient en sommant
   tous les effectifs situés sur la deuxième ligne, soit `r nb_indus`.
   
**Q2.** En sommant toutes les valeurs du tableau, on obtient `r nb_tot`. La
   part des entreprises industrielles est donc de
   $\frac{`r round(nb_indus, 1)`}{`r round(nb_tot, 1)`}=`r round(part_indus, 3)`$, il
   s'agit d'une des 5 valeurs de la distribution marginale des
   entreprises selon le secteur d'activité.
   
**Q3.**  Le nombre d'entreprises dont le nombre de salariés est compris
   entre 10 et 20 est obtenu en sommant les 5 valeurs situées dans la
   troisième colonne du tableau, soit `r round(nb_1020, 1)`. 

**Q4.**  La part des entreprises dont le nombre de salariés est compris
   entre 10 et 20 est de $\frac{`r round(nb_1020, 1)`}
   {`r round(nb_tot, 1)`}= 
   `r round(part_1020, 3)`$. Il s'agit d'une des 4 valeurs de la
   distribution marginale des entreprises selon la taille.
   
**Q5.** La part des entreprises qui sont industrielles et dont le nombre de
   salariés est compris entre 10 et 20 est égal au rapport entre le
   nombre d'entreprises qui vérifie ces deux conditions 
   (`r round(nb_1020_indus, 1)`) et le nombre total d'entreprises
   (`r round(nb_tot, 1)`),
   soit $`r round(nb_1020_indus / nb_tot, 2)`$. Il s'agit d'une
   des 20 valeurs de la distribution jointe des entreprises selon la
   taille et le secteur d'activité. 
   
**Q6.** La part des entreprises industrielles dont le nombre de salariés
   est compris entre 10 et 20 s'obtient en divisant le nombre
   d'entreprises qui sont industrielles et dont la taille est comprise
   entre 10 et 20 (`r round(nb_1020_indus, 1)`) par le nombre total d'entreprises
   industrielles (`r round(nb_indus, 1)`), soit 
   $`r round(nb_1020_indus / nb_indus, 3)`$. Il s'agit d'une des 4
   valeurs de la distribution des entreprises selon la taille
   conditionnellement au secteur d'activité (pour le secteur industriel).

**Q7.** La part des entreprises dont le nombre de salariés est compris
   entre 10 et 20 qui sont des entreprises industrielles s'obtient en
   divisant le nombre d'entreprises industrielles de la taille
   comprise entre 10 et 20 (`r nb_1020_indus`) par le nombre total
   d'entreprises de taille entre 10 et 20 (`r nb_1020`), soit 
   $`r round(nb_1020_indus / nb_1020, 3)`$. Il s'agit d'une des 5 valeurs
   de la distribution des entreprises selon le secteur d'activité
   conditionnellement à la taille (ici un nombre de salariés compris
   entre 10 et 20).


### Exercice 2 {-}

#### Intitulé

On considère la distribution des familles de Seine-et-Marne selon le
nombre de voitures et le type de famille (`couple` indique les
couples, avec ou sans enfants et `monop` les familles monoparentales,
c'est-à-dire une famille constituée d'un seul adulte et de un ou
plusieurs enfants).

```{r echo = FALSE, message = FALSE}
voit <- RGP77 %>% mutate(voitures = ifelse(voitures == 3, 2, voitures)) %>%
    cont_table(voitures, type, total = TRUE) %>% mutate(n = n / 1000)
voit %>% pre_print %>%
    knitr::kable(booktabs = TRUE, escape = FALSE, digits = 2) %>%
    kableExtra::kable_styling(position = "center")
```

1. Calculez la distribution marginale des ménages selon le nombre de
   voitures.
1. Calculez la distribution des ménages selon le nombre de voitures
   conditionnellement au type de famille.
1. Calculez les moyennes conditionnelles du nombre de voitures.
1. Calculez de deux manières différentes le nombre moyen de voitures
   par famille.

#### Corrigé
   
```{r echo = FALSE}
tot <- pre_print(voit)[4, 4, drop = TRUE]
marg <- voit %>% pre_print %>% pull(Total) %>% .[-4] / tot
marg_type <- voit %>% marginal(type) %>% pull(f)
couples <- voit %>% pre_print %>% pull(couple)
monop <- voit %>% pre_print %>% pull(monop)
tot_monop <- monop[4]
tot_couples <- couples[4]
cond_couples <- couples[-4] / tot_couples
cond_monop <- monop[-4] / tot_monop
tot_voits <- voit %>% pre_print %>% .[4] %>% pull
moy_monop <- sum(cond_monop * (0:2))
moy_couples <- sum(cond_couples * (0:2))
```    

**Q1.** La distribution marginale des ménages selon le nombre de voitures
   s'obtient en divisant la colonne `Total` par le nombre total de
   ménage (situé à l'intersection de la dernière ligne et de la
   dernière colonne). Par exemple, la première valeur de cette
   distribution est de $\frac{`r round(tot_voits[1], 2)`}
   {`r round(tot_voits[4], 2)`} = `r round(marg[1], 3)`$. Pour une
   et deux voitures, on a respectivement `r round(marg[2],3)` et 
   `r round(marg[3],3)`.
   
**Q2.** La distribution conditionnelle des ménages selon le nombre de
   voitures conditionnellement au type de famille s'obtient en
   divisant, par exemple pour les couples, le nombre de couples
   possédant $k$ voitures par le nombre total de couples. Par exemple,
   pour $0$ voiture, on obtient $\frac{`r round(couples[1], 2)`}
   {`r round(tot_couples, 2)`}=`r round(cond_couples[1], 3)`$.
   Globalement, les probabilités conditionnelles sont données dans le
   tableau ci-dessous.
   
```{r echo = FALSE}
voit %>% conditional(voitures) %>% pre_print %>% rename(voitures = 1) %>% 
    knitr::kable(booktabs = TRUE, escape = FALSE, digits = 3) %>%
        kableExtra::kable_styling(position = "center")
```

**Q3.**  Les moyennes conditionnelles s'obtiennent en calculant la moyenne
   pondérée du nombre de voitures par les probabilités
   conditionnelles. Pour les couples, on obtient\ :
   $`r round(cond_couples[1], 2)` \times 0 +
   `r round(cond_couples[2], 2)` \times 1 +
   `r round(cond_couples[3], 2)` \times 2=
   `r round(sum(cond_couples * (0:2)), 2)`$,
   alors que pour les familles monoparentales, on a\ :
   $`r round(cond_monop[1], 2)` \times 0 +
   `r round(cond_monop[2], 2)` \times 1 +
   `r round(cond_monop[3], 2)` \times 2=
   `r round(sum(cond_monop * (0:2)), 2)`$.
   
**Q4.** On peut calculer le nombre moyen de voitures en utilisant la
   distribution marginale des ménages selon le nombre de voitures\ :
   $`r round(marg[1], 2)` \times 0 +
   `r round(marg[2], 2)` \times 1 +
   `r round(marg[3], 2)` \times 2=
   `r round(sum(marg * (0:2)), 2)`$. On peut également faire la
   moyenne des moyennes conditionnelles, pondérées par les
   fréquences marginales de la variable de conditionnement\ :
   $`r round(marg_type[1], 2)` \times `r round(moy_couples, 2)` +
   `r round(marg_type[2], 2)` \times `r round(moy_monop, 2)` =
   `r round(marg_type[1] * moy_couples + marg_type[2] * moy_monop, 2)`$.
