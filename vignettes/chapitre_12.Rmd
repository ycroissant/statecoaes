---
title: Exercices corrigés du chapitre 12
author: Yves Croissant
output: 
  html_document:
    toc: true
    toc_float: true
  pdf_document:
    number_sections: true
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{Exercices corrigés du chapitre 12}
  %\VignetteEngine{knitr::rmarkdown}
---

### Exercice 1 {-}

#### Intitulé

On considère la taille des joueurs de basket américains (NBA). Il y a
400 joueurs professionnels et le population totale des hommes adultes
américains est de 117 millions.  La moyenne et l'écart-type de la
taille sont de 175/10 cm dans la population américaine et de 201/9 cm
pour les joueurs de baskets.

On considère les joueurs suivants :

- Mugsy Bugs : 1m60,
- Yao Ming : 2m29
- Marc Gasol : 2m11

On fera l'hypothèse que la distribution des individus selon la taille
est normale.

**Q1.** Quelle taille font les 1% américains les plus grands ?

**Q2.** Quelle taille font les 1% basketteurs les plus grands ?

**Q3.** Combien y a t'il d'adultes américains au moins aussi grand que
Marc Gasol ? Même question pour Yao Ming.

**Q4.** Combien y a t'il en moyenne de joueurs de basket au moins aussi grand que
   Marc Gasol ? Même question pour Yao Ming.

**Q5.** Quelle taille font les 1% américains les plus petit et les 1%
basketteurs les plus petits ?

**Q6.** Combien y a t'il de joueurs de basket de taille inférieure ou
égale à celle de Mugsy Bugs.


```{r echo = FALSE, results = 'hide'}
fmt <- function(x) format(x, scientific = FALSE, big.mark = " ")
N <- 117E06
B <- 400
mu <- 175
sig <- 10
mub <- 201
sigb <- 9
qnorm(0.01, mu, sig, lower.tail = FALSE)
pnorm(216, mu, sig, lower.tail = FALSE) * N
pnorm(229, mu, sig, lower.tail = FALSE) * N
```

#### Corrigé

**Q1.** Dans la population américaine, la taille moyenne est de 
`r mu`, l'écart-type de `r sig` et on suppose que la distribution est
normale. En notant $x$ la taille, on a donc $z = \frac{x - `r mu`}
{`r sig`}$ qui suit une loi normale centrée réduite. La valeur recherchée
est le quantile de niveau 0.99. En lisant dans une table, on trouve la
valeur $2.33$ qui correspond la probabilité de 0.$9901$. On pose donc
$z_{0.99} = 2.33$. On obtient donc $x_{0.99} = `r mu` + z_{0.99} `r sig` = 
`r round(mu + 2.33 * sig, 2)`$. Le même résultat peut être obtenu à
l'aide de la fonction `qnorm`. Avec pour seul argument une
probabilité, la fonction renvoie le quantile pour distribution normale
centrée réduite. 

```{r collapse = TRUE}
qnorm(0.99)
qnorm(0.01, lower.tail = FALSE)
```
On peut alors appliquer le calcul précédent\ :

```{r }
mu + sig * qnorm(0.99)
```

On peut également utiliser `qnorm` avec deux arguments
supplémentaires, la moyenne et l'écart-type\ :

```{r  collapse = TRUE}
qnorm(0.99, mu, sig)
qnorm(0.01, mu, sig, lower.tail = FALSE)
```

**Q2.** Par un raisonnement similaire, on considère, pour les
basketteurs, une taille moyenne égale à `r mub` et un écart-type de 
`r sigb`. On obtient alors\ :


```{r }
qnorm(0.99, mub, sigb)
```

**Q3.** Le pourcentage d'américains de taille au moins égale à celle
de Marc Gasol est donnée par la fonction de répartition normale, en
utilisant la moyenne et l'écart-type pour la population. On commence
donc à transformer la taille de ce joueur (2m11) en retirant la
moyenne et en divisant par l'écart-type. On obtient\ :
$\frac{211 - `r mu`}{`r sig`} = `r round( (211-mu)/sig, 3)`$. En
lisant dans la table normale, on obtient pour cette valeur de la
variable la probabilité $0.99984$. Le nombre de personnes
correspondant est donc de $0.00016 \times `r fmt(117E06)` = 
`r round(0.00016 * 117E06, 2)`$. Avec **R**, on utilisera la fonction
`pnorm`. Sans autre argument que la valeur de la variable, elle revoie
la probabilité associée à une variable normale centrée réduite, mais
on peut également indiquer comme arguments supplémentaires la moyenne
et l'écart-type\ :


```{r  collapse = TRUE}
pnorm(3.6, lower.tail = FALSE) * 117E06
pnorm(211, mu, sig, lower.tail = FALSE) * 117E06
```

Pour Yao Ming, on a\ :
$\frac{229 - `r mu`}{`r sig`} = `r round( (229-mu)/sig, 3)`$. Cette
valeur est tellement élevée qu'elle ne figure pas dans la table. En
revanche, on peut de nouveau utiliser la fonction `pnorm`\ :

```{r  collapse = TRUE}
pnorm(5.4, lower.tail = FALSE) * 117E06
pnorm(229, mu, sig, lower.tail = FALSE) * 117E06
```

**Q4.** On suit le même raisonnement que précédemment, mais en
utilisant l'effectif (`r B`),  la moyenne (`r mub`) et l'écart-type
(`r sigb`) des joueurs de basket. On obtient pour Marc Gasol\ :

```{r }
pnorm(211, mub, sigb, lower.tail = FALSE) * 400
```

Pour Yao-Ming\ :

```{r }
pnorm(229, mub, sigb, lower.tail = FALSE) * 400
```
Soit moins de 1 sur 400, ce joueur est d'une taille particulièrement élevée.

**Q5.** Dans la population américaine, la taille moyenne est de 
`r mu`, l'écart-type de `r sig` et on suppose que la distribution est
normale. En notant $x$ la taille, on a donc $z = \frac{x - `r mu`}
{`r sig`}$ qui suit une loi normale centrée réduite. La valeur recherchée
est le quantile de niveau 0.01. Par symétrie, il s'agit au signe près
de la même valeur que dans la question 1, soit  $-2.33$ qui correspond à
la probabilité de 0.$9901$. On pose donc\ :
$z_{0.01} = -2.33$. On obtient donc $x_{0.01} = `r mu` + z_{0.01} `r sig` = 
`r round(mu - 2.33 * sig, 2)`$. Le même résultat peut être obtenu à
l'aide de la fonction `qnorm`. Avec pour seul argument une
probabilité, la fonction renvoie le quantile pour distribution normale
centrée réduite. 

```{r collapse = TRUE}
mu + sig * qnorm(0.01)
qnorm(0.01, mu, sig)
```
Pour les joueurs de basket, on obtient\ :

```{r }
mub + sigb * qnorm(0.01)
```

**Q6.** Le basketteur Mugsy Bugs mesure 1m60. Avec $\mu = `r mu`$ et
$\sigma = `r sig`$ (les paramètres de la distribution pour les adultes
américains, on obtient une valeur de la variable normale centrée
réduite de $\frac{160 - `r mu`}{`r sig`} = `r round( (160 - mu) / sig,
3)`$.  La probabilité associée à `r round( (160 - mu) / sig, 3)` est
`r round(pnorm((160 - mu) / sig), 3)`, soit un nombre de personnes
dans la population de\ : `r fmt(round(pnorm((160 - mu) / sig) *
117E06))`

```{r }
pnorm(160, mu, sig) * 117E06
```

Si on considère maintenant les joueurs de basket\ :


```{r }
pnorm(160, mub, sigb) * 400
```

Soit 0.01 joueur sur 400 ! Muggsy Bugs était un incroyablement petit
pour un joueur de basket professionnel , le plus petit de toute
l'histoire de la NBA.

### Exercice 2 {-}

#### Intitulé

On considère un trajet domicile travail constitué d'un temps de
conduite fixe de 10mn et d'un temps d'attente à un péage qui est en
moyenne de 10mn et qui par hypothèse suit une loi exponentielle. La
journée de travail commence à 9h00. 

**Q1.** Quel est l'écart-type du temps d'attente au péage.

**Q2.** Quel est la probabilité d'attendre au moins 15mn au péage ?

**Q3.** Quel est la probabilité d'attendre au moins 25mn au péage,
sachant qu'on y est déjà depuis 10mn.

**Q4.** Quelle est l'heure de départ qui permet d'arriver à l'heure
avec une probabilité de 90%

#### Corrigé

```{r include = FALSE}
lambda <- 0.1
```

**Q1.** Une des propriétés de la loi exponentielle est que
l'écart-type est égal à la moyenne, il est donc égal à 10.

**Q2.** La probabilité que le temps d'attente soit inférieur ou égal à
$x$ est donnée par la fonction de répartition $F(x) = 1 - e^{-\lambda
x}$. La probabilité d'attendre au moins 15mn est donc donnée par $1 -
F(15)=e^{-\lambda 15} = 
`r round(pexp(15, rate = lambda, lower.tail = FALSE) * 100, 2)`$%.

**Q3.** La probabilité d'attendre au moins 25 mn au péage est $1 -
F(25)=e^{-\lambda 25} = `r round(pexp(25, rate = lambda, lower.tail = FALSE) * 100, 2)`$%.
La probabilité d'attendre au moins 10mn au péage est $1 -
F(10)=e^{-\lambda 10} = `r round(pexp(10, rate = lambda, lower.tail = FALSE) * 100, 2)`$%.
La probabilité d'attendre au moins 15 mn supplémentaire sachant que
l'attente est déjà de 10mn est donné par $\mbox{P}(X > t + s | X > t)
= \frac{\mbox{P}(X > t + s \cap X > t)}{\mbox{P}(X > t)}
= \frac{\mbox{P}(X > t + s)}{\mbox{P}(X > t)}=\frac{e^{-\lambda (t + s)}}
{e^{-\lambda t}} = e^{-\lambda s} = \mbox{P}(X > s)$ (avec $t=10$ et
$s=15$). On a ici :
$\frac{`r round(pexp(25, rate = lambda, lower.tail = FALSE), 3)`}
{`r round(pexp(10, rate = lambda, lower.tail = FALSE), 3)`} = 
`r round(pexp(15, rate = lambda, lower.tail = FALSE), 3)`$.
On illustre ici la propriété d'absence de mémoire d'une variable
suivant une loi exponentielle, c'est-à-dire que la probabilité
d'attendre au moins 15mn au péage est la même si je viens d'arriver au
péage ou si j'y suis déjà depuis 10mn.

**Q4.** On doit déterminer la fonction de quantile d'une variable
suivant une distribution exponentielle. La fonction de répartition est
$F(x)=1-e^{-\lambda x}$. La fonction quantile est la fonction
réciproque, qui permet d'exprimer une valeur de la variable en
fonction d'une probabilité. On obtient : $F^{-1}(x) = -\frac{\ln (1 -
p)}{\lambda}$. Pour $p = 0.1$, on obtient $`r round(- log(1 - 0.9) /0.1, 1)`$mn.
Pour arriver à l'heure 90 fois sur 100, il faut donc partir à 8h27.



