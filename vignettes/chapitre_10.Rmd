---
title: Exercices corrigés du chapitre 10
author: Yves Croissant
output: 
  html_document:
    toc: true
    toc_float: true
  pdf_document:
    number_sections: true
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{Exercices corrigés du chapitre 10}
  %\VignetteEngine{knitr::rmarkdown}
---

### Exercice 1 {-}

#### Intitulé

La température moyenne à New-York est de $\mu_F=56$ degrés Fahrenheit,
avec un écart-type de $\sigma_F=23$. La relation entre les degrés
Celsius $C$ et les degrés Fahrenheit $F$ est $C = \frac{5}{9} (F -
32)$.

Calculer la moyenne et l'écart-type de la température à New-York en
degrés Celsius.

#### Corrigé

La température en Celsius est une fonction affine de la température en
Fahrenheit. On a donc $\mu_C = \frac{5}{9} \mu_F = \frac{5}{9} \times
(56 -32) = 13.3$ degrés. La variance en degrés Celsius est $\sigma_C^2 =
\left(\frac{5}{9}\right)^2 \sigma_F^2$ ou encore, l'écart-type est
$\sigma_C = \frac{5}{9} \sigma_F = \frac{5}{9} \times 23 = 12.8$.

### Exercice 2 {-}

#### Intitulé

On considére un système d'impôt sur le revenu très simplifié :

- la distribution du revenu $R$ est uniforme sur l'intervalle $[1,4]$
  (l'unité est le milliers d'euros par mois),
- le taux d'impôt sur le revenu est $\tau=0.4$ (on a donc un impôt
  proportionnel),
- un système de crédit d'impôt permet de déduire de l'impôt certaines
  dépenses (pensions alimentaires, dons à des oeuvres par exemple) et
  la distribution du crédit d'impôt est uniforme sur l'intervalle
  $[0,3]$,
- on suppose que le montant du crédit d'impôt ($A$) est indépendant du
  revenu.

**Q1.** Calculez l'espérance et la variance du revenu.

**Q2.** Calculez l'espérance et la variance du crédit d'impôt.

**Q3.** Calculez l'espérance et la variance de l'impôt.

**Q4.** Calculez la covariance et le coefficient de corrélation
linéaire entre l'impôt et le revenu.

#### Corrigé

**Q1.** La densité du revenu est par hypothèse constante, égale à
$\frac{1}{4 - 1} = \frac{1}{3}$ pour $R \in [1, 4]$. En utilisant les
formules de la section précédente, l'espérance et la variance du
revenu sont $\mu_R = \frac{1 + 4}{2} = 2.5$ et
$\sigma^2_R= \frac{(4 - 1) ^ 2}{12} = 0.75$.

**Q2.** En appliquant les mêmes formules que précédemment, on
obtient\ : $\mu_A = 0.15$ et $\sigma^2_A = 0.0075$.

**Q3.**
Pour calculer l'impôt sur le revenu, on applique le taux d'imposition
$\tau$ au revenu et on déduit l'abattement $A$. L'impôt est donc la
variable aléatoire $I$ suivante :

$$
I = \tau R - A
$$

qui est une fonction affine de deux variables aléatoires. On a donc\ :

$$
\mu_I = \mbox{E}(\tau R - A) = 
\tau \mu_R - \mu_A = 0.4 \times 2.5 - 0.15 = 0.85
$$

$$ \sigma_I ^ 2 = \mbox{V}(\tau R - A) = 
\tau ^ 2 \sigma^2_R + \sigma^2_A - 2 \tau \sigma_{RA}$$

Or, par hypothèse l'abattement et le revenu sont indépendants. On a
donc finalement\ :

$$\sigma_I ^ 2 = \tau ^ 2 \sigma^2_R + \sigma^2_A  = 
0.4 ^ 2 \times 0.75 + 0.0075 = 0.1275$$


**Q4.**
La covariance est définie par\ :

$$
\sigma_{RI} = \mbox{E}\left[(R - \mu_R)(I -
\mu_I)\right] = \mbox{E}(RI) - \mu_R\mu_I
$$

On a ici $I = \tau R - A$ et $I - \mu_I = \tau(R - \mu_R) -
(A-\mu_A)$. Par conséquent\ :

$$
\begin{array}{rcl}
\sigma_{RI} &=& \mbox{E}\left[(R - \mu_R)
\left(\tau(R - \mu_R) - (A-\mu_A)\right)\right] \\
&=& \tau \mbox{E}\left[(R - \mu_R) ^ 2\right] - \mbox{E}\left[(R -
\mu_R)(A - \mu_A)\right]  \\
&=& \tau \sigma_R ^ 2 -  \sigma_{RA} \\
&=& \tau \sigma_R ^ 2
\end{array}
$$

La dernière égalité résultant de l'hypothèse d'indépendance de la
distribution du revenu et de l'abattement. On obtient ici\ :
$\sigma_{RI} = 0.4 \times 0.75 = 0.3$.

Enfin, le coefficient de corrélation linéaire est égal au rapport
entre la variance et le produit des écarts-type :

$$
\rho_{RI}=\frac{\sigma_{RI}}{\sigma_R\sigma_I}=\frac{\tau \sigma_R ^ 2}{\sigma_R\sigma_I}
$$

On obtient dans notre exemple, en réarrangeant les termes :

$$
\rho_{RI} = \frac{\tau}{\sqrt{\tau ^ 2 +
\frac{\sigma_A^2}{\sigma_R^2}}} = 0.971
$$


```{r eval = FALSE, include = FALSE}
tau <- 0.4
mu_R = 2.5
V_R = .75
mu_A = 0.15
V_A = 0.0075
mu_I = tau *  mu_R - mu_A
V_I = tau ^ 2 * V_R + V_A
sigma_RA = tau * V_R
sigma_RA / sqrt(V_R * V_I)
tau / sqrt(tau ^ 2 + V_A / V_R)


R <- 1E03
r <- runif(R, min = 1, max = 4)
a <- runif(R, min = 0, max = 0.3)
tau <- 0.4
i <- tau * r - a
tibble(r, a, i) %>% ggplot(aes(r, i)) + geom_point()
```


```{r include = FALSE, eval = FALSE}
degre <- c(20, 32, 40, 70, 80, 90)
jour <- c(16, 66, 124, 365 - c(141, 75, 12)) / 365
z <- qnorm(jour)
plot(z ~ degre)
abline(lm(z ~ degre))
```
