---
title: Exercices corrigés du chapitre 11
author: Yves Croissant
output: 
  html_document:
    toc: true
    toc_float: true
  pdf_document:
    number_sections: true
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{Exercices corrigés du chapitre 11}
  %\VignetteEngine{knitr::rmarkdown}
---

### Exercice 1 {-}

#### Intitulé

Une compagnie pétrolière souhaite réaliser des forages dans un pays
afin de trouver du pétrole. Différentes concessions peuvent être
attribuées, chacune d'entre elle correspondant à un nombre donné de
forages à effectuer. La probabilité qu'un forage soit fructueux dépend
du nombre de forages effectués. Plus précisément, on considère que la
relation entre la probabilité qu'un forage soit fructueux et le nombre
de forages effectués est donnée par la fonction\ : $p = 0.7 - 0.1 n$.

1. Déterminez les probabilités d'effectuer 0, 1, 2 ou 3 forages
fructueux pour une concession pour laquelle trois forages sont
réalisés.
1. En cas de forage fructueux, le gain pour l'entreprise est
de 100. Calculez le gain moyen pour l'entreprise lorsqu'elle réalise
trois forages.
1. Le coût d'un forage est de 50. Calculez le profit moyen de
l'entreprise pour trois forages.
1. Quelle est la probabilité que le profit soit positif en réalisant
trois forages ?
1. Déterminez l'expression générale du profit moyen en fonction du
nombre de forages.
1. Déterminez le nombre de forages qui maximise le profit moyen.

#### Corrigé


**Q1.** On applique la formule :
$\mbox{P}(X = x)=C^x_n p^x (1-p) ^ {(1-x)} = \frac{n !}{x ! (n - x)
!}p^x (1-p) ^ {(1-x)}$. On obtient\ :

- $x = 0$ \ : $1 \times 0.4 ^ 0 \times 0.6 ^ 3 = `r round(dbinom(0, 3, 0.4), 3)`$,
- $x = 1$ \ : $3 \times 0.4 ^ 1 \times 0.6 ^ 2 = `r round(dbinom(1, 3, 0.4), 3)`$,
- $x = 2$ \ : $3 \times 0.4 ^ 2 \times 0.6 ^ 1 = `r round(dbinom(2, 3, 0.4), 3)`$,
- $x = 3$ \ : $1 \times 0.4 ^ 3 \times 0.6 ^ 0 = `r round(dbinom(3, 3, 0.4), 3)`$.

**Q2.** On peut utiliser les probabilités précédentes pour calculer la
recette moyenne\ :

$$
(`r round(dbinom(0, 3, 0.4), 3)` \times 0 +
`r round(dbinom(1, 3, 0.4), 3)` \times 1 +
`r round(dbinom(2, 3, 0.4), 3)` \times 2 +
`r round(dbinom(3, 3, 0.4), 3)` \times 3 ) \times 100
= 1.2 \times 100 = 120
$$

Plus simplement, on utilise le résultat que l'espérance d'une variable
binomiale est $n\times p$. On obtient donc $n\times p \times 100 = 1.2
\times 100 = 120$.

**Q3.** Le profit moyen est l'écart entre la recette moyenne et le
coût, soit $\Pi = 100 n p - 50 n$. Pour $n=3$, on a $p = 0.4$ et donc
un profit moyen de $\Pi = 100 \times 3 \times 0.4 - 50 \times 3 = -30$.

**Q4.** Le profit est égal à $100 \times x - 50 \times 3$. Il est
positif si $x \geq 1.5$. Comme le nombre de forages est forcément un
nombre entier, cela correspond donc à $\mbox{P}(X \geq 2)$. On obtient
ici $\mbox{P}(X = 2) + \mbox{P}(X = 3)=
`r round(dbinom(2, 3, 0.4), 3)` + `r round(dbinom(3, 3, 0.4), 3)` =
`r round(pbinom(1, 3, 0.4, lower.tail = FALSE), 3)`$

**Q5.** L'expression générale du profit moyen est\ : $\Pi = 100 n p -
50 n$. En remplaçant $p$ par $0.7 - 0.1 n$, on obtient\ :

$$
\Pi = 100 n (0.7 - 0.1 n) - 50 n = 20 n - 10 \times n ^ 2
$$

**Q6.** La valeur de $n$ qui maximise le profit moyen vérifie\ :

$$
\frac{\partial \Pi}{\partial n} = 20 - 20 n = 0
$$

On obtient $n = 1$
                                      

### Exercice 2 {-}

#### Intitulé

On considère un pays de $n=100$ personnes dans lequel le risque annuel
d'avoir un accident de voiture est de $p=0.005$. En cas d'accident, le
coût pour la personne accidentée est de $s=1000$ euros.

1. Quel est le coût moyen pour la collectivité de l'accidentologie\ ?
1. Quelle est la distribution suivie par le nombre d'accidents
   annuel\ ?  Quel est le nombre moyen et la variance du nombre d'accidents ?
1. Calculez à nouveau la moyenne et la variance en appliquant
l'approximation de la loi de Poisson. Commentez le résultat.

    Un système d'assurance complet est mis en place, ce qui signifie qu'en
    cas d'accident, l'indemnité de la compagnie d'assurance $r$ est
    $r=s$. Chaque habitant paye une cotisation annuelle de $c$ euros. Dans
    ce cas la probabilité d'avoir un accident devient égale à 0.01.
  
1. Expliquez pourquoi la mise en place d'une assurance se traduit
par un accroissement de la probabilité d'avoir un accident.
1. Écrivez la fonction de profit de la compagnie
d'assurance. Déterminez le montant de la cotisation $c$ qui correspond
à un profit en moyenne nul pour la compagnie d'assurance.
1. Calculez la probabilité que la compagnie d'assurance soit en
déficit, en utilisant l'approximation de la loi de Poisson.

    La compagnie d'assurance ne rembourse désormais le sinistre qu'à
    hauteur de 90% en cas d'accident. On parle en assurance de mécanisme
    de franchise, l'assuré devant supporter une part $\alpha=0.1$ du
    sinistre. Dans ce cas, la probabilité d'occurence d'un accident est de
    $q=0.008$.

1. Calculez à nouveau le montant de la cotisation qui correspond à un
profit en moyenne nul pour la compagnie d'assurance et la
probabilité que la compagnie soit en déficit.
1. Calculez la valeur moyenne du coût pour la collectivité des
accidents de voiture dans les deux situations d'assurance.

#### Corrigé

**Q1.** Le coût pour la collectivité de l'accidentologie est égal à
$s=1000$ multiplié par le nombre d'accidents (soit 0 s'il n'y a pas
d'accident, 1000 s'il y a un accident, 2000 s'il y a deux accidents,
etc.). La probabilité qu'il y ait un accident étant de 0.5% et la
population étant de 100, le nombre moyen d'accidents annuel est de 0.5
et le coût moyen annuel de l'accidentologie pour le pays est donc de
500 euros. 

**Q2.** Pour chacune des $n=100$ personnes, la probabilité d'avoir un
accident est $p=0.005$. Avec les hypothèses que cette probabilité soit
la même pour les $n=100$ personnes et que ces probabilités soient
indépendantes, le nombre total d'accidents est une variable binomiale
de paramètres $n=100$ et $p=0.005$. Pour une variable binomiale, on a
$\mbox{E}(X)=n\times p = 100 \times 0.005 = 0.5$ et 
$\mbox{V}(X)=n\times p \times (1 - p) = 100 \times 0.005 \times 0.995 = 0.4975$.
La variance est très proche de l'espérance car on l'obtient en
multipliant l'espérance par un facteur $1-p$ très proche de 1. 

**Q3.** L'approximation de Poisson indique que si $n$ tend vers l'infini, $p$
est faible et $n\times p$ tend vers une valeur finie, alors la
variable binomiale converge vers une variable de Poisson de paramètre
$\lambda = p \times n$. Ces hypothèses sont vérifiées ici et on peut
donc approximer le nombre d'accidents dans le pays par une variable de
Poisson de paramètre $\lambda=0.05$. L'espérance est alors
$\lambda=0.05$ (comme précédemment) et la variance $\lambda=0.05$
(contre $0.0475$ précédemment). 

**Q4.** L'augmentation de la probabilité d'occurrence d'un accident en
cas de mise en place d'un système d'assurance est le symptôme d'un
phénomène plus général appelé *risque moral*. Comme l'automobiliste
sait qu'il sera indemnisé en cas d'accident, il prend moins de
précautions au niveau de sa conduite (il roule par exemple plus vite
ou téléphone au volant) que dans le cas où il doit supporter lui-même
les conséquences monétaires de l'accident. 

**Q5.** La recette de la compagnie d'assurance est le montant total
des cotisations, soit $N\times c$, elle est fixe. Le coût de la
compagnie est en revanche aléatoire, puisqu'il s'agit du montant des
indemnités versées, qui dépend du nombre d'accidents constatés $x
\times r$ (avec $r=s$ puisqu'on considère une assurance complète). On
a donc $\Pi = N c - x r$. L'espérance de $x$ étant $Np$, on a
$\mbox{E}(\Pi) = Nc - Npr$. Le profit moyen est nul si $c=pr=ps$, soit
dans notre exemple $c=0.01\times 1000=10$. La recette (certaine) de la
compagnie d'assurance est alors de $10 \times 100=1000$ et l'espérance
de son coût de $0.01 \times 1000 = 1000$. 

**Q6.** S'il n'y a pas d'accident, la compagnie fait un profit
puisqu'elle dispose d'une recette de 1000 et qu'elle n'a pas de
remboursements à effectuer. S'il y a un accident, le profit est nul
car le remboursement de 1000 est exactement égal à la recette. À
partir de deux accidents, le remboursement devient au moins égal à
2000 et le profit devient négatif. La probabilité que le profit soit
positif est donc égale à $\mbox{P}(X \leq 1)$, soit la somme des masses
de probabilités associées aux valeurs 0 et 1. Bien évidemment la
probabilité associée à un profit négatif est le complément à
l'unité. Pour une loi de Poisson de paramètre 1, les probabilités
associées aux valeurs de 0 et de 1 sont égales à 
$`r round(dpois(0, 1), 3)`$, on a donc une probabilité de déficit
égale à $1 - `r round(dpois(0, 1), 3)` - `r round(dpois(1, 1), 3)` = 
`r round(ppois(1, 1, lower.tail = FALSE), 3)`$.

```{r collapse = TRUE}
1 - (dpois(0, 1) + dpois(1, 1))
1 - ppois(1, 1)
ppois(1, 1, lower.tail = FALSE)
```

Cette probabilité correspond à l'approximation de la loi binomiale par
la loi de Poisson. Le calcul des probabilités exactes donne\ :

```{r collapse = TRUE}
1 - (dbinom(0, 100, 0.01) + dbinom(1, 100, 0.01))
1 - pbinom(1, 100, 0.01)
pbinom(1, 100, 0.01, lower.tail = FALSE)
```
La différence est négligeable, ce qui confirme la pertinence du choix
d'utiliser l'approximation de Poisson.


**Q7.** Le profit de la compagnie d'assurance est désormais de $\Pi =
N c - x (1-\alpha)s$, $x$ étant désormais une variable binomiale de
paramètres $N=100$ et $q=0.008$. L'espérance du profit est 
$\mbox{E}(\Pi) = N c - qN (1-\alpha)s$ et donc, le profit moyen est
nul si $c=q(1-\alpha)s = 0.008\times 1000 \times 0.9 = 7.2$. La
recette (certaine) est de $100 \times 7.2 = 72$ et la dépense est de 0
s'il n'y a pas d'accident, de $90$ s'il y a un accident, de $180$ s'il
y a deux accidents, etc. Par conséquent, le profit devient négatif dès
qu'il y a au moins un accident. On calcule de la même manière cette
probabilité en utilisant soit la fonction de probabilité cumulative
d'une variable binomiale de paramètres $n=100$ et $q=0.008$ ou celle
d'une variable de Poisson de paramètre $\lambda = n\times p = 0.8$.


```{r collapse = TRUE}
pbinom(0, 100, 0.008, lower.tail = FALSE)
ppois(0, 0.8, lower.tail = FALSE)
```

La probabilité d'avoir un déficit augmente fortement. 


**Q8.** En termes d'espérance, les deux systèmes sont équivalents pour
la compagnie d'assurance qui, dans les deux cas, réalise un profit
d'espérance nulle. Pour les individus, le coût dans le système
d'assurance complet est\ :

- pour un individu non accidenté\ : $c = 10$ (le paiement de sa
  cotisation),
- pour un individu accidenté\ : $c + s - r = 10 + 100 - 100 = 10$ (le
  paiement de sa cotisation, augmenté du coût du sinistre et réduit
  par le versement de l'assurance).
  
Dans un système d'assurance complet, la situation d'un accidenté et
d'un non accidenté sont les mêmes car le sinistre est intégralement
remboursé. On a donc globalement pour l'ensemble de la collectivité un
coût de $10 \times 100 = 1000$.

Dans le système avec franchise, le coût est\ :

- pour un individu non accidenté\ : $c = 7.2$ (le paiement de sa
  cotisation),
- pour un individu accidenté\ : $c + s - r = 7.2 + 100 - 90 = 17.2$ (le
  paiement de sa cotisation, augmenté du coût du sinistre et réduit
  par le versement de l'assurance).

La probabilité d'être accidenté étant de $q=0.008$, l'espérance du
coût pour chaque individu est donc de $(1-0.008)\times 7.2 + 0.008
\times 17.2=`r round(0.992*7.2+0.008*17.2, 2)`$ et l'espérance du coût
pour l'ensemble des individus est donc de\ :
$100 \times `r round(0.992*7.2+0.008*17.2, 2)` = `r round(100*(0.992*7.2+0.008*17.2))`$.
Le système avec franchise semble préférable à celui de l'assurance
complète parce qu'il permet de réduire le risque d'accident. 

